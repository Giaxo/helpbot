(this["webpackJsonpcalendar-web-ros"]=this["webpackJsonpcalendar-web-ros"]||[]).push([[0],{123:function(e,t,a){},149:function(e,t,a){},151:function(e,t,a){},194:function(e,t,a){},199:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(8),l=a.n(s),c=(a(123),a(111)),o=a(17),r=a(95),i=(a(126),a(9)),v=a.n(i),d=(a(98),a(96)),j=a(27),m=a.n(j),u=(a(149),a(38)),b=a.n(u),y=(a(150),a(116)),O=a(92),p=a(91),f=(a(151),a(5));Object(u.registerLocale)("it",y.a),Object(u.setDefaultLocale)("it");var h=function(e){var t=Object(n.useState)(""),a=Object(o.a)(t,2),s=a[0],l=a[1],c=Object(n.useState)(!1),r=Object(o.a)(c,2),i=r[0],v=r[1],d=Object(n.useState)(new Date),j=Object(o.a)(d,2),m=j[0],u=j[1],y=Object(n.useState)("0"),h=Object(o.a)(y,2),w=h[0],x=h[1],N=Object(n.useState)(new Date),S=Object(o.a)(N,2),g=S[0],C=S[1],T=Object(n.useState)(new Date),D=Object(o.a)(T,2),E=D[0],k=D[1],R=Object(n.useState)("Promemoria"),M=Object(o.a)(R,2),Y=M[0],H=M[1];return Object(f.jsx)("div",{className:"new-event-overlay",style:e.show?{}:{display:"none"},children:Object(f.jsxs)("div",{className:"new-event-overlay-content",children:[Object(f.jsx)("img",{className:"new-event-overlay-close",src:"plus.png",onClick:e.onClose,alt:"close overlay plus"}),Object(f.jsxs)("form",{className:"new-event-overlay-form",onSubmit:function(t){return e.onSubmit(t,s,i,m,w,g,E,Y)},children:[Object(f.jsxs)("div",{className:"new-event-overlay-input",children:[Object(f.jsx)("div",{className:"new-event-overlay-label",children:"Nome evento:"}),Object(f.jsx)("input",{className:"new-event-overlay-text",type:"text",value:s,onChange:function(e){l(e.target.value)}})]}),Object(f.jsx)("div",{className:"new-event-overlay-input",children:Object(f.jsxs)("label",{className:"new-event-overlay-label",children:[Object(f.jsx)("input",{type:"checkbox",id:"isWeekly",name:"newEventIsWeekly",checked:i,onChange:function(e){v(e.target.checked)}}),"Settimanale"]})}),Object(f.jsxs)("div",{className:"new-event-overlay-input",children:[Object(f.jsx)("div",{className:"new-event-overlay-label",children:"Seleziona il giorno:"}),Object(f.jsx)("div",{style:i?{display:"none"}:{},children:Object(f.jsx)(b.a,{className:"new-event-overlay-datepicker",selected:m,onChange:function(e){return u(e)},dateFormat:"dd/MM/yyyy",locale:"it",onChangeRaw:function(e){e.preventDefault()},strictParsing:!0})}),Object(f.jsxs)("select",{className:"new-event-overlay-select",name:"newEventWeekday",id:"newEventWeekday",value:w,onChange:function(e){x(e.target.value)},style:i?{}:{display:"none"},children:[Object(f.jsx)("option",{value:"0",children:"Luned\xec"}),Object(f.jsx)("option",{value:"1",children:"Marted\xec"}),Object(f.jsx)("option",{value:"2",children:"Mercoled\xec"}),Object(f.jsx)("option",{value:"3",children:"Gioved\xec"}),Object(f.jsx)("option",{value:"4",children:"Venerd\xec"}),Object(f.jsx)("option",{value:"5",children:"Sabato"}),Object(f.jsx)("option",{value:"6",children:"Domenica"})]})]}),Object(f.jsxs)("div",{className:"new-event-overlay-input",children:[Object(f.jsx)("div",{className:"new-event-overlay-label",children:"Seleziona l'ora iniziale:"}),Object(f.jsx)(b.a,{className:"new-event-overlay-datepicker",selected:g,onChange:function(e){return C(e)},locale:"it",showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:5,timeCaption:"Time",dateFormat:"HH:mm",onChangeRaw:function(e){e.preventDefault()},strictParsing:!0})]}),Object(f.jsxs)("div",{className:"new-event-overlay-input",children:[Object(f.jsx)("div",{className:"new-event-overlay-label",children:"Seleziona l'ora finale:"}),Object(f.jsx)(b.a,{className:"new-event-overlay-datepicker",selected:E,onChange:function(e){return k(e)},locale:"it",showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:5,minTime:g.getTime(),maxTime:Object(O.default)(Object(p.default)(new Date,59),23),timeCaption:"Time",dateFormat:"HH:mm",onChangeRaw:function(e){e.preventDefault()},strictParsing:!0})]}),Object(f.jsxs)("div",{className:"new-event-overlay-input",children:[Object(f.jsx)("div",{className:"new-event-overlay-label",children:"Seleziona il tipo:"}),Object(f.jsx)("select",{className:"new-event-overlay-select",name:"newEventType",id:"newEventType",value:Y,onChange:function(e){H(e.target.value)},children:e.eventTypes.map((function(e){return Object(f.jsx)("option",{value:e,children:e},e)}))})]}),Object(f.jsx)("input",{className:"new-event-overlay-submit",type:"submit",value:"Crea evento"})]})]})})};a(194);var w=function(e){var t=e.selEvent;if(null!=t){var a,n=t.title,s=t.resource.isWeekly;a=s?v()(t.start).format("dddd"):v()(t.start).format("DD MMMM YYYY");var l=v()(t.start).format("HH:mm"),c=v()(t.end).format("HH:mm"),o=t.resource.type;return Object(f.jsx)("div",{className:"details-overlay",style:e.show?{}:{display:"none"},children:Object(f.jsxs)("div",{className:"details-overlay-content",children:[Object(f.jsx)("img",{className:"details-overlay-close",src:"plus.png",onClick:e.onClose,alt:"close overlay plus"}),Object(f.jsxs)("div",{className:"details-overlay-details",children:[Object(f.jsxs)("div",{className:"details-overlay-label",children:["Nome evento:",Object(f.jsx)("div",{className:"details-overlay-info",children:n})]}),Object(f.jsxs)("div",{className:"details-overlay-label",children:["Data:",Object(f.jsx)("div",{className:"details-overlay-info",children:a})]}),Object(f.jsxs)("div",{className:"details-overlay-label",children:["Ora:",Object(f.jsxs)("div",{className:"details-overlay-info",children:[l," - ",c]})]}),Object(f.jsxs)("div",{className:"details-overlay-label",children:["Tipo evento:",Object(f.jsx)("div",{className:"details-overlay-info",children:o})]}),Object(f.jsxs)("div",{className:"details-overlay-remove-button",onClick:function(){e.onRemoveClick(t)},children:["Elimina ",s?"ogni "+a:""]})]})]})})}return null},x=Object(r.b)(v.a),N=new m.a.Ros({url:"ws://192.168.1.66:9090"});N.on("connection",(function(){console.log("Connected to websocket server.")})),N.on("error",(function(e){console.log("Error connecting to websocket server: ",e)})),N.on("close",(function(){console.log("Connection to websocket server closed.")}));var S=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),a=t[0],s=t[1],l=Object(n.useState)([]),i=Object(o.a)(l,2),j=i[0],u=i[1],b=Object(n.useState)(new Date),y=Object(o.a)(b,2),O=y[0],p=y[1],S=Object(n.useState)(!1),g=Object(o.a)(S,2),C=g[0],T=g[1],D=Object(n.useState)(!1),E=Object(o.a)(D,2),k=E[0],R=E[1],M=Object(n.useState)(null),Y=Object(o.a)(M,2),H=Y[0],I=Y[1],W=new m.a.Service({ros:N,name:"/read_calendar",serviceType:"helpbot/ReadCalendar"}),L=new m.a.Service({ros:N,name:"/read_types",serviceType:"helpbot/ReadTypes"}),J=new m.a.Service({ros:N,name:"/add_event",serviceType:"helpbot/AddEvent"}),V=new m.a.Service({ros:N,name:"/remove_event",serviceType:"helpbot/RemoveEvent"}),z=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];function A(e,t){p(e),a.length=0;var n=v()(e).format("YYYY"),l=v()(e).format("MM"),o=new m.a.ServiceRequest({year:n,month:l});W.callService(o,(function(e){var t=JSON.parse(e.calendar),a=t.daily,o=t.weekly,r=[];for(var i in a){var j=a[i];for(var b in j){var y=j[b],O={};O.start=v()(n+"-"+l+"-"+i+" "+y.startTime[0]+":"+y.startTime[1]).toDate(),O.end=v()(n+"-"+l+"-"+i+" "+y.endTime[0]+":"+y.endTime[1]).toDate(),O.title=y.name,O.resource={type:y.type,isWeekly:!1},r.push(O)}}var p=0;for(var f in o){var h=o[f],w=new d.a({freq:d.a.WEEKLY,interval:1,byweekday:p,dtstart:new Date(Date.UTC(parseInt(n),parseInt(l)-1,1)),until:new Date(Date.UTC(parseInt(n),parseInt(l),0))}).all();for(var x in h){var N,S=Object(c.a)(w);try{for(S.s();!(N=S.n()).done;){var g=N.value,C=h[x],T={};T.start=new Date(g.setHours(C.startTime[0],C.startTime[1])),T.end=new Date(g.setHours(C.endTime[0],C.endTime[1])),T.title=C.name,T.resource={type:C.type,isWeekly:!0},r.push(T)}}catch(E){S.e(E)}finally{S.f()}}p+=1}s(r);var D=new m.a.ServiceRequest;L.callService(D,(function(e){u(JSON.parse(e.types))}))}),(function(e){console.log("NO SERVICE CONNECTION")}))}function q(){T(!C)}function P(){R(!k)}return Object(n.useEffect)((function(){A(v()().toDate())}),[]),Object(f.jsxs)("div",{className:"App",children:[Object(f.jsx)("div",{className:"calendar-header",children:Object(f.jsxs)("div",{className:"new-event-button",onClick:q,children:[Object(f.jsx)("img",{className:"new-event-plus",src:"plus.png",alt:"add avent plus"}),"Nuovo evento"]})}),Object(f.jsx)("div",{className:"calendar-container",children:Object(f.jsx)(r.a,{localizer:x,events:a,views:["month","day","agenda"],messages:{allDay:"Giorno",previous:"Precedente",next:"Successivo",today:"Oggi",month:"Mese",week:"Settimana",day:"Giorno",agenda:"Agenda",date:"Data",time:"Ora",event:"Evento",showMore:function(e){return"+ ".concat(e," altri eventi")}},onNavigate:A,onSelectEvent:function(e,t){I(e),P()}})}),Object(f.jsx)(h,{show:C,onSubmit:function(e,t,a,n,s,l,c,o){if(e.preventDefault(),""!==t&&null!==n&&null!==l&&null!==c){T(!1);var r,i={name:t,startTime:[v()(l).format("HH"),v()(l).format("mm")],endTime:[v()(c).format("HH"),v()(c).format("mm")],type:o};r=a?z[s]:{year:v()(n).format("YYYY"),month:v()(n).format("MM"),day:v()(n).format("DD")};var d=new m.a.ServiceRequest({event:JSON.stringify(i),date:JSON.stringify(r),isWeekly:a});J.callService(d,(function(e){"0"===e.resultCode?A(O):console.log("ERROR IN ADD EVENT SERVICE CALL")}))}},onClose:q,eventTypes:j}),Object(f.jsx)(w,{show:k,onRemoveClick:function(e){R(!1);var t,a=e.title,n=e.resource.isWeekly;t=n?z[(e.start.getDay()+6)%7]:{year:v()(e.start).format("YYYY"),month:v()(e.start).format("MM"),day:v()(e.start).format("DD")};var s=new m.a.ServiceRequest({eventName:a,date:JSON.stringify(t),isWeekly:n});V.callService(s,(function(e){"0"===e.resultCode?A(O):console.log("ERROR IN REMOVE EVENT SERVICE CALL")}))},onClose:P,selEvent:H})]})};l.a.render(Object(f.jsx)(S,{}),document.getElementById("root"))}},[[199,1,2]]]);
//# sourceMappingURL=main.5302f904.chunk.js.map